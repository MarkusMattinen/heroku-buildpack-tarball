#!/usr/bin/env bash

set -e            # fail fast
set -o pipefail   # dont ignore exit codes when piping output
# set -x          # enable debugging

cd $1
mkdir -p app
mv app.tar.gz app

cd app
tar zxf app.tar.gz

if [ -d "app" ]; then
  (shopt -s dotglob; mv -- app/* .)
fi

rm -rf app.tar.gz

if [ -d "../.git" ]; then
  rm -rf .git
fi

cd ..
(shopt -s dotglob; mv -- app/* .)
rmdir app
